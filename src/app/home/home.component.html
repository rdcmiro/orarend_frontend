<app-logged-header></app-logged-header>

<div class="home-container">
  <!-- Bal: √ìrarend -->
  <div class="schedule-section">
    <h2>√ìrarend</h2>

    <!-- üü¶ Vizu√°lis √≥rarend -->
    <div class="timetable-wrapper" *ngIf="lessons.length > 0; else noLessons">
      <!-- Id≈ës√°v oszlop bal oldalt -->
      <div class="times-column">
        <div class="time-label" *ngFor="let time of timeSlots">
          {{ time }}
        </div>
      </div>

      <!-- R√°cs a napokkal √©s √≥r√°kkal -->
      <div class="timetable-grid">
        <!-- Napfejl√©cek -->
        <div class="cell header" *ngFor="let day of weekDays">
          {{ day }}
        </div>

        <!-- √ìr√°k -->
        <div
          *ngFor="let lesson of lessons"
          class="lesson-card"
          [style.gridColumn]="getColumn(lesson.dayOfWeek)"
          [style.gridRow]="getRow(lesson.startTime) + ' / span ' + getRowSpan(lesson)"
          @shrinkOut
        >
          <strong>{{ lesson.className }}</strong>
          <div class="lesson-time">
            {{ lesson.startTime }} - {{ lesson.endTime }}
          </div>
        </div>
      </div>
    </div>

    <ng-template #noLessons>
      <div class="schedule-placeholder">
        üìÖ Nincs m√©g √≥ra felv√©ve.
      </div>
    </ng-template>
  </div>

  <!-- K√∂z√©p: Teend≈ëk -->
  <div class="todo-section">
    <h2>Teend≈ëk</h2>

    <table
      mat-table
      [dataSource]="todos"
      class="mat-elevation-z8 lesson-table"
      *ngIf="todos.length > 0; else noTodos"
    >
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>√Ållapot</th>
        <td mat-cell *matCellDef="let todo">
          <mat-checkbox [(ngModel)]="todo.done"></mat-checkbox>
        </td>
      </ng-container>

      <ng-container matColumnDef="text">
        <th mat-header-cell *matHeaderCellDef>Teend≈ë</th>
        <td mat-cell *matCellDef="let todo">{{ todo.text }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="todoColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: todoColumns"></tr>
    </table>

    <ng-template #noTodos>
      <div class="schedule-placeholder">
        ‚úÖ Minden k√©sz, nincs teend≈ë!
      </div>
    </ng-template>
  </div>

  <!-- Jobb oldali sidebar -->
  <div class="sidebar">
    <button
      mat-raised-button
      color="accent"
      class="add-button"
      (click)="onAddLesson()"
    >
      + √ìra hozz√°ad√°sa
    </button>

    <button
      mat-raised-button
      color="warn"
      class="manage-button"
      (click)="onManageLessons()"
      style="margin-top: 12px;"
    >
      üóëÔ∏è √ìr√°k kezel√©se
    </button>
  </div>
</div>
