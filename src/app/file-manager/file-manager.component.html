<app-logged-header></app-logged-header>

<div class="home-container">
  <div class="file-page">
    <h2 class="page-title">ğŸ“„ FÃ¡jlok Ã©s AI Ã¶sszefoglalÃ¡s</h2>

    <!-- ğŸ“¤ FeltÃ¶ltÃ©s blokk -->
    <div class="upload-card">
      <h3>ğŸ“¤ FÃ¡jl feltÃ¶ltÃ©se</h3>
      <div class="upload-row">
        <input type="file" (change)="onSelect($event)" />
        <button
          mat-raised-button
          color="primary"
          (click)="onUpload()"
          [disabled]="!selectedFile || loading"
        >
          FeltÃ¶ltÃ©s
        </button>
      </div>
    </div>

    <!-- ğŸ“‹ FÃ¡jl lista -->
    <div class="files-card" *ngIf="hasLoaded && files.length > 0; else noFiles">
      <h3>ğŸ“‚ FÃ¡jljaid</h3>

      <div
        class="file-item"
        *ngFor="let file of files"
        [@listAnimation]
        [class.selected]="file.selected"
      >
        <mat-checkbox [(ngModel)]="file.selected"></mat-checkbox>
        <div class="file-info">
          <strong>{{ file.filename }}</strong>
          <span class="meta">{{ file.uploadedAt | date: 'yyyy.MM.dd. HH:mm' }}</span>
        </div>

        <!-- ğŸ’¾ LetÃ¶ltÃ©s gomb -->
        <button
          mat-icon-button
          color="primary"
          (click)="onDownload(file.id)"
          [disabled]="loading"
          matTooltip="LetÃ¶ltÃ©s"
        >
          <mat-icon>download</mat-icon>
        </button>
      </div>
    </div>

    <ng-template #noFiles>
      <p class="empty">MÃ©g nincsenek feltÃ¶ltÃ¶tt fÃ¡jljaid.</p>
    </ng-template>

    <!-- ğŸ§  Ã–sszefoglalÃ¡s -->
    <div class="actions" *ngIf="uploadedFileId">
      <button
        mat-raised-button
        color="accent"
        class="summarize-button"
        (click)="onSummarize()"
        [disabled]="loading"
      >
        ğŸ§  Ã–sszefoglalÃ¡s
      </button>
    </div>

    <mat-progress-bar *ngIf="loading" mode="indeterminate"></mat-progress-bar>

    <pre class="result" *ngIf="summaryText">{{ summaryText }}</pre>
  </div>
</div>
